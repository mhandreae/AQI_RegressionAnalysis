---
title: "Logistic regression AQI data"
author: "Michael Andreae"
date: "July, 14, 2015"
output: pdf_document
---

# Insurance status predicts antiemetic use 
We investigate the Hypothesis that insurance status predicets antiemetic use the population in the Public Use File of the Anestehsia Quality Institute with electronic anesthesia records recording antiemetic use.



```{r, packages, message=FALSE, echo=FALSE, warning=FALSE}
library(knitr) # required to set options in Markdown R
```



```{r, global_options, echo=FALSE}

# set the directory to the project directory
setwd("C:/Users/Micheal/Dropbox/Professional/AQI/AQI_RegressionAnalysis")

# set options
opts_chunk$set(fig.width=6, fig.height=4, fig.path='Figs/',
               echo=FALSE, warning=FALSE, message=FALSE)
```

## Load cleaned dataset *myAQI_4_14.Rdata* 
 
we load the cleaned larger dataset without provider information *fullAQI_4_14.Rdata*, which we generated in *import_AQI_14Jul2015.Rmd*   


```{r, echo=TRUE}
rm(list = ls())
load("Analysis/Data/fullAQI_4_14.Rdata")
str(fullAQI_4_14)
```

## Logistic Regression

### Logistic Model 1

We fit a logistic regression model with the a logit link.


```{r, echo=TRUE}
formula <- ond ~ pay +age_group +sex +ASA +anes_type +duration +practice  

fit_logistic <- glm(formula, 
                   family = binomial(link = "logit"), 
                   data = fullAQI_4_14)
```

Controlling for age, sex, facilty and case duration, antiemetic administration is strongly associated with insurance status as a marker of SES.

```{r, echo=FALSE}
p_values <- summary.glm((fit_logistic))$coefficient[,4]
OR <- exp(coef(fit_logistic)) # exponentiated coefficients
kable(data.frame(OR, p_values), digits = 3)

#summary(fit_logistic) # display results
#confint(fit_logistic) # 95% CI for the coefficients
#exp(confint(fit_logistic)) # 95% CI for exponentiated coefficients
#predict(fit_logistic, type="response") # predicted values
#residuals(fit_logistic, type="deviance") # residuals
```


